<html>
<body>
{% autoescape off %}
{% if result %}
<h1>{{result.title}}</h1>
<p>{{result.description|linebreaksbr}}</p>
	{% if changes %}
<ul>
		{% for change in changes %}
			{% if change.type == 2 %}
	<li>{{change.name}} has increased to level {{change.new}}!</li>
			{% elif change.type == 3 %}
	<li>You gained {{change.amount}} {{change.name}}, for a new total of {{change.new}}.</li>
			{% elif change.type == 5 and change.old == 0 %}
	<li>You now have {{change.new}} {{change.name}}{{change.new|pluralize}}.</li>
			{% elif change.type == 5  and change.amount < 0 and change.new == 0%}
	<li>You lost your {{change.name}}{{change.old|pluralize}}.</li>
			{% elif change.type == 5  and change.amount < 0 %}
{# Using widthratio is a bizarre but approved way to do math in a django template. #}
	<li>You lost {%widthratio -1 1 change.amount%} {{change.name}}, for a new total of {{change.new}}.</li>
			{% elif change.type == 5 %}
	<li>You gained {{change.amount}} {{change.name}}{{change.amount|pluralize}}, for a new total of {{change.new}}.</li>
			{% elif change.type == 1 %}
	<li>{{change.name}} has increased by {{change.amount}} point{{change.amount|pluralize}}.</li>
			{% elif change.type == 6 and change.amount < 0 %}
	<li>Your health has dropped from {{change.old}} to {{change.new}}.</li>
			{% elif change.type == 6 %}
	<li>Your health has increased from {{change.old}} to {{change.new}}.</li>
			{% endif %}
			{% if change.type == 13 %}
	<li>You have learned the way to {{change.name}} and can travel here in the future.</li>
			{% endif %}
			{% if change.type == 14 %}
	<li>You are now in {{change.name}}.</li>
			{% endif %}
		{% endfor %}
</ul>
	{% endif %}
<a href="/lok/story/"><p>Carry on, then.</p></a>
{% else %}
<p>Yikes, how did you get here? You aren't supposed to be able to get here. There must be some mistake. I'm sorry. Please visit us again later.</p>
{% endif %}
{% endautoescape %}
</body>
</html>
